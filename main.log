INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1490091]
INFO:     Started server process [1491928]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:49755 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:49755 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:49756 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1491928]
INFO:     Started server process [1496412]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:49769 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:49769 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:49770 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:49773 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1496412]
INFO:     Started server process [1498892]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:49781 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:49781 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:49782 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1498892]
INFO:     Started server process [1500789]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:49788 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:49788 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:49789 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     Started server process [66930]
INFO:     Waiting for application startup.
2025-09-18 02:37:39,761 - MainProcess - INFO - main - Starting application...
2025-09-18 02:37:39,769 - MainProcess - INFO - main - Running initial funding rate check...
2025-09-18 02:37:39,770 - MainProcess - ERROR - main - Error in monitoring scheduler: This event loop is already running
/home/duc/backend-get-data-/src/service/scheduler_service.py:46: RuntimeWarning: coroutine 'FundingRateMonitorService.check_funding_rate_data' was never awaited
  logger.error(f"Error in monitoring scheduler: {str(e)}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-09-18 02:37:39,771 - MainProcess - INFO - main - Monitoring scheduler started, checking every 3600 seconds
2025-09-18 02:37:39,771 - MainProcess - INFO - main - Monitoring system started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:43446 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:43446 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:37832 - "POST /monitoring/funding_rate/check-async HTTP/1.1" 200 OK
2025-09-18 02:38:10,635 - MainProcess - INFO - main - Starting funding rate data check...
2025-09-18 02:38:10,653 - MainProcess - ERROR - main - Error checking API: Cannot connect to host localhost:8000 ssl:default [Connect call failed ('127.0.0.1', 8000)]
2025-09-18 02:38:16,098 - MainProcess - INFO - main - Telegram message sent successfully
2025-09-18 02:38:16,098 - MainProcess - WARNING - main - Detected 5 symbols missing data: ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'ADAUSDT', 'XRPUSDT']
2025-09-18 02:38:58,126 - MainProcess - INFO - main - Starting funding rate data check...
2025-09-18 02:38:58,134 - MainProcess - ERROR - main - Error checking API: Cannot connect to host localhost:8000 ssl:default [Connect call failed ('127.0.0.1', 8000)]
2025-09-18 02:38:59,476 - MainProcess - INFO - main - Telegram message sent successfully
2025-09-18 02:38:59,476 - MainProcess - WARNING - main - Detected 5 symbols missing data: ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'ADAUSDT', 'XRPUSDT']
INFO:     127.0.0.1:47208 - "GET /monitoring/funding_rate/check HTTP/1.1" 200 OK
INFO:     Started server process [524771]
INFO:     Waiting for application startup.
2025-09-18 14:08:51,748 - MainProcess - INFO - main - Starting application...
2025-09-18 14:08:51,748 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 14:08:51,748 - MainProcess - INFO - main - Shutting down application...
2025-09-18 14:08:51,748 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [593902]
INFO:     Waiting for application startup.
2025-09-18 15:04:02,684 - MainProcess - INFO - main - Starting application...
2025-09-18 15:04:02,684 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:04:02,685 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:04:02,685 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [600391]
INFO:     Waiting for application startup.
2025-09-18 15:08:32,697 - MainProcess - INFO - main - Starting application...
2025-09-18 15:08:32,697 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:08:32,697 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:08:32,697 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [600557]
INFO:     Waiting for application startup.
2025-09-18 15:08:36,617 - MainProcess - INFO - main - Starting application...
2025-09-18 15:08:36,617 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:08:36,618 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:08:36,618 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [606977]
INFO:     Waiting for application startup.
2025-09-18 15:13:35,163 - MainProcess - INFO - main - Starting application...
2025-09-18 15:13:35,163 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:13:35,163 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:13:35,163 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [612405]
INFO:     Waiting for application startup.
2025-09-18 15:17:54,378 - MainProcess - INFO - main - Starting application...
2025-09-18 15:17:54,378 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:57298 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:57298 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:57310 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 15:24:17,145 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:24:17,146 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [612405]
INFO:     Started server process [620918]
INFO:     Waiting for application startup.
2025-09-18 15:24:21,389 - MainProcess - INFO - main - Starting application...
2025-09-18 15:24:21,389 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:50364 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:50364 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50354 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
2025-09-18 15:25:05,271 - MainProcess - INFO - main - Starting funding rate data check...
2025-09-18 15:25:05,271 - MainProcess - INFO - main - Not in funding rate check window. Next: 2025-09-18 16:00:00
INFO:     127.0.0.1:50374 - "GET /crypto/monitoring/check HTTP/1.1" 200 OK
INFO:     127.0.0.1:51030 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51042 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:47266 - "GET /crypto/monitoring/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:47280 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:39838 - "GET /crypto/btc_dominance_historical/1000 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49768 - "GET /crypto/btc_dominance_historical/10000 HTTP/1.1" 200 OK
INFO:     Started server process [637299]
INFO:     Waiting for application startup.
2025-09-18 15:37:40,577 - MainProcess - INFO - main - Starting application...
2025-09-18 15:37:40,577 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:37:40,577 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:37:40,577 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     127.0.0.1:37338 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:37338 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     Started server process [638108]
INFO:     Waiting for application startup.
2025-09-18 15:38:17,866 - MainProcess - INFO - main - Starting application...
2025-09-18 15:38:17,866 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:38:17,867 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:38:17,867 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Started server process [638691]
INFO:     Waiting for application startup.
2025-09-18 15:38:42,671 - MainProcess - INFO - main - Starting application...
2025-09-18 15:38:42,671 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8010): address already in use
INFO:     Waiting for application shutdown.
2025-09-18 15:38:42,671 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:38:42,671 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     127.0.0.1:56484 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:56484 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-18 15:39:00,057 - MainProcess - INFO - main - Starting funding rate data check...
2025-09-18 15:39:00,057 - MainProcess - INFO - main - Not in funding rate check window. Next: 2025-09-18 16:00:00
INFO:     127.0.0.1:56490 - "GET /crypto/monitoring/check HTTP/1.1" 200 OK
INFO:     192.168.110.164:37750 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 404 Not Found
2025-09-18 15:40:14,022 - MainProcess - INFO - main - Starting funding rate data check...
2025-09-18 15:40:14,022 - MainProcess - INFO - main - Not in funding rate check window. Next: 2025-09-18 16:00:00
INFO:     192.168.110.164:37752 - "GET /crypto/monitoring/check HTTP/1.1" 200 OK
INFO:     Started server process [641052]
INFO:     Waiting for application startup.
2025-09-18 15:40:33,736 - MainProcess - INFO - main - Starting application...
2025-09-18 15:40:33,736 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:58200 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:58200 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-18 15:40:46,934 - MainProcess - INFO - main - Checking funding rate data...
INFO:     127.0.0.1:58204 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-18 15:40:58,447 - MainProcess - INFO - main - Checking BTC dominance realtime data...
2025-09-18 15:40:58,459 - MainProcess - WARNING - main - BTC DOMINANCE ALERT: Data is 520.97 minutes old (tolerance: 30 minutes)
INFO:     127.0.0.1:58210 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
2025-09-18 15:41:00,418 - MainProcess - INFO - main - Checking BTC dominance realtime data...
2025-09-18 15:41:00,429 - MainProcess - WARNING - main - BTC DOMINANCE ALERT: Data is 521.01 minutes old (tolerance: 30 minutes)
INFO:     127.0.0.1:58210 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
2025-09-18 15:41:19,143 - MainProcess - INFO - main - Checking funding rate data...
INFO:     192.168.110.164:57660 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-18 15:41:29,513 - MainProcess - INFO - main - Checking BTC dominance realtime data...
2025-09-18 15:41:29,515 - MainProcess - WARNING - main - BTC DOMINANCE ALERT: Data is 521.49 minutes old (tolerance: 30 minutes)
INFO:     192.168.110.164:44242 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 15:47:18,215 - MainProcess - INFO - main - Shutting down application...
2025-09-18 15:47:18,215 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [641052]
INFO:     Started server process [649130]
INFO:     Waiting for application startup.
2025-09-18 15:47:20,368 - MainProcess - INFO - main - Starting application...
2025-09-18 15:47:20,368 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:49278 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:49290 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:49290 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:49298 - "GET /crypto/funding_rate_historical/BTCUSDT/10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55262 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55268 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     127.0.0.1:55268 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     127.0.0.1:49908 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
2025-09-18 15:48:31,464 - MainProcess - INFO - main - Checking funding rate data for all cycles...
INFO:     127.0.0.1:49918 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-18 15:48:57,878 - MainProcess - INFO - main - Checking BTC dominance data for today...
2025-09-18 15:48:57,882 - MainProcess - INFO - main - Found 1 BTC dominance records for today
INFO:     127.0.0.1:39154 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
INFO:     192.168.110.176:55448 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:55448 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:55449 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:55449 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:55467 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:55467 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-18 15:54:52,313 - MainProcess - INFO - main - Checking funding rate data for all cycles...
INFO:     192.168.110.164:38322 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
INFO:     192.168.110.176:55475 - "GET / HTTP/1.1" 200 OK
INFO:     192.168.110.176:55478 - "GET /health HTTP/1.1" 200 OK
INFO:     192.168.110.176:55599 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:55599 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:55860 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:55860 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:55861 - "GET /crypto/funding_rate_historical/BTCUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:56218 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:56218 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:56302 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:56302 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.160:54224 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.160:54224 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.160:54239 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:54311 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:54327 - "GET /crypto/btc_dominance_historical/100 HTTP/1.1" 200 OK
INFO:     192.168.110.160:54335 - "GET /crypto/btc_dominance_historical/100000 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57125 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.160:57125 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.160:57141 - "GET /crypto/funding_rate_historical/BTC/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57153 - "GET /crypto/funding_rate_historical/BTC/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57160 - "GET /crypto/funding_rate_historical/BTCUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57173 - "GET /crypto/funding_rate_historical/BTCUSDT/0 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/duc_le/backend-get-data-/src/controller/v1/funding_rate.py", line 22, in get_funding_rate_controller
    response = await service.get_funding_rate_data(request)
  File "/home/duc_le/backend-get-data-/src/service/funding_rate_service.py", line 86, in get_funding_rate_data
    docs = await loop.run_in_executor(None, _query)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/duc_le/backend-get-data-/src/service/funding_rate_service.py", line 62, in _query
    recent_dates = [doc["_id"] for doc in coll.aggregate(date_pipeline)]
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/collection.py", line 3015, in aggregate
    return self._aggregate(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/collection.py", line 2913, in _aggregate
    return self._database.client._retryable_read(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/mongo_client.py", line 2047, in _retryable_read
    return self._retry_internal(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/_csot.py", line 125, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/mongo_client.py", line 2014, in _retry_internal
    ).run()
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/mongo_client.py", line 2765, in run
    return self._read() if self._is_read else self._write()
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/mongo_client.py", line 2926, in _read
    return self._func(self._session, self._server, conn, read_pref)  # type: ignore
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/aggregation.py", line 164, in get_cursor
    result = conn.command(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/helpers.py", line 47, in inner
    return func(*args, **kwargs)
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/pool.py", line 452, in command
    return command(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/synchronous/network.py", line 212, in command
    helpers_shared._check_command_response(
  File "/home/duc_le/backend-get-data-/.venv/lib/python3.10/site-packages/pymongo/helpers_shared.py", line 284, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: the limit must be positive, full error: {'ok': 0.0, 'errmsg': 'the limit must be positive', 'code': 15958, 'codeName': 'Location15958'}
INFO:     192.168.110.160:57178 - "GET /crypto/funding_rate_historical/BTCUSDT/1 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57178 - "GET /crypto/funding_rate_historical/BTCUSDT/2 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57210 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57212 - "GET /crypto/btc_dominance_historical/10 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57232 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
INFO:     192.168.110.160:57253 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:57264 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:57269 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:57269 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:57269 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
2025-09-22 08:50:42,175 - MainProcess - INFO - main - Checking funding rate data for all cycles...
INFO:     192.168.110.160:57285 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
INFO:     192.168.110.160:57303 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:57315 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:57318 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:57318 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:57327 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
2025-09-22 08:57:16,269 - MainProcess - INFO - main - Checking funding rate data for all cycles...
INFO:     192.168.110.160:57547 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-22 08:57:23,052 - MainProcess - INFO - main - Checking funding rate data for all cycles...
INFO:     192.168.110.160:57550 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-22 09:01:53,224 - MainProcess - INFO - main - Checking BTC dominance data for today...
2025-09-22 09:01:53,234 - MainProcess - INFO - main - Found 1 BTC dominance records for today
INFO:     192.168.110.160:57793 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
2025-09-22 09:02:01,913 - MainProcess - INFO - main - Checking BTC dominance data for today...
2025-09-22 09:02:01,915 - MainProcess - INFO - main - Found 1 BTC dominance records for today
INFO:     192.168.110.160:57802 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
INFO:     192.168.110.176:57343 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:57343 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:57344 - "GET /crypto/funding_rate_historical/BTCUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:57386 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
INFO:     192.168.110.176:57412 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.176:57414 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
2025-09-22 13:03:41,114 - MainProcess - INFO - main - Checking funding rate data for all cycles...
2025-09-22 13:03:41,121 - MainProcess - WARNING - main - FUNDING RATE 1H ALERT: 3 symbols missing data at 2025-09-22 13:00:00: BTCUSDT, ETHUSDT, BNBUSDT
INFO:     192.168.110.176:57416 - "GET /crypto/monitoring/funding-rate HTTP/1.1" 200 OK
2025-09-22 13:03:57,341 - MainProcess - INFO - main - Checking BTC dominance data for today...
2025-09-22 13:03:57,351 - MainProcess - INFO - main - Found 1 BTC dominance records for today
INFO:     192.168.110.176:57418 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
2025-09-22 13:03:59,073 - MainProcess - INFO - main - Checking BTC dominance data for today...
2025-09-22 13:03:59,084 - MainProcess - INFO - main - Found 1 BTC dominance records for today
INFO:     192.168.110.176:57418 - "GET /crypto/monitoring/btc-dominance HTTP/1.1" 200 OK
INFO:     192.168.110.176:57420 - "GET / HTTP/1.1" 200 OK
INFO:     192.168.110.176:57422 - "GET /health HTTP/1.1" 200 OK
INFO:     192.168.110.176:57424 - "GET /crypto/funding_rate_historical/BTCUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:57500 - "GET /crypto/funding_rate_historical/DOGEUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:57531 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.176:57585 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:57585 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:57586 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.176:57589 - "GET /crypto/btc_dominance_historical/50 HTTP/1.1" 200 OK
INFO:     192.168.110.176:57623 - "GET /crypto/funding_rate_historical/DOGEUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:59828 - "GET /crypto/funding_rate_historical/DOGEUSDT/10 HTTP/1.1" 200 OK
INFO:     192.168.110.176:59845 - "GET /crypto/funding_rate_historical/DOGEUSDT/10000 HTTP/1.1" 200 OK
INFO:     192.168.110.160:54041 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
INFO:     192.168.110.160:54324 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.176:60084 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:60084 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:60085 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.176:60099 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.176:60185 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.176:60185 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.176:60185 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.176:60185 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-22 17:22:06,241 - MainProcess - INFO - main - Shutting down application...
2025-09-22 17:22:06,248 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [649130]
INFO:     Started server process [3596456]
INFO:     Waiting for application startup.
2025-09-22 17:22:10,498 - MainProcess - INFO - main - Starting application...
2025-09-22 17:22:10,498 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:60246 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:60246 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:60247 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-22 17:31:54,990 - MainProcess - INFO - main - Shutting down application...
2025-09-22 17:31:54,991 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [3596456]
INFO:     Started server process [3609164]
INFO:     Waiting for application startup.
2025-09-22 17:31:59,177 - MainProcess - INFO - main - Starting application...
2025-09-22 17:31:59,177 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     192.168.110.176:60343 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.176:60343 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.176:60344 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:59511 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.160:59511 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.160:59543 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.110.160:59543 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.110.160:59736 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:59736 - "GET /crypto/funding_rate_historical/BTCUSDT/2 HTTP/1.1" 200 OK
INFO:     192.168.110.160:59808 - "GET /crypto/funding_rate_realtime/BTCUSDT HTTP/1.1" 200 OK
INFO:     192.168.110.160:59814 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
INFO:     192.168.110.160:59826 - "GET /crypto/btc_dominance_realtime/ HTTP/1.1" 200 OK
INFO:     192.168.110.160:59869 - "GET /crypto/btc_dominance_historical/5 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-23 17:21:59,654 - MainProcess - INFO - main - Shutting down application...
2025-09-23 17:21:59,655 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [3609164]
INFO:     Started server process [1144739]
INFO:     Waiting for application startup.
2025-09-23 17:22:01,836 - MainProcess - INFO - main - Starting application...
2025-09-23 17:22:01,836 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:60656 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:60656 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-23 17:24:15,575 - MainProcess - INFO - main - Shutting down application...
2025-09-23 17:24:15,576 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [1144739]
INFO:     Started server process [1147478]
INFO:     Waiting for application startup.
2025-09-23 17:24:19,729 - MainProcess - INFO - main - Starting application...
2025-09-23 17:24:19,729 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:56214 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:56214 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:56218 - "GET /crypto/btc-dominance/10 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-23 17:28:42,571 - MainProcess - INFO - main - Shutting down application...
2025-09-23 17:28:42,571 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [1147478]
INFO:     Started server process [1152939]
INFO:     Waiting for application startup.
2025-09-23 17:28:46,722 - MainProcess - INFO - main - Starting application...
2025-09-23 17:28:46,722 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:35018 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:35018 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-23 17:29:06,362 - MainProcess - INFO - main - Getting ETF candlestick data for 10 days, symbol: E1VFVN30
2025-09-23 17:29:06,362 - MainProcess - ERROR - main - Error getting ETF candlestick data: 'MongoDBConfig' object has no attribute 'get_database'
INFO:     127.0.0.1:35028 - "GET /crypto/etf-candlestick/10/E1VFVN30 HTTP/1.1" 200 OK
2025-09-23 17:29:09,879 - MainProcess - INFO - main - Getting ETF candlestick data for 10 days, symbol: E1VFVN30
2025-09-23 17:29:09,880 - MainProcess - ERROR - main - Error getting ETF candlestick data: 'MongoDBConfig' object has no attribute 'get_database'
INFO:     127.0.0.1:35028 - "GET /crypto/etf-candlestick/10/E1VFVN30 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-23 17:33:17,404 - MainProcess - INFO - main - Shutting down application...
2025-09-23 17:33:17,405 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [1152939]
INFO:     Started server process [1158645]
INFO:     Waiting for application startup.
2025-09-23 17:33:21,648 - MainProcess - INFO - main - Starting application...
2025-09-23 17:33:21,648 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
INFO:     127.0.0.1:57716 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:57716 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-23 17:33:42,392 - MainProcess - INFO - main - Getting ETF candlestick data for 10 days, symbol: E1VFVN30
2025-09-23 17:33:42,393 - MainProcess - ERROR - main - Error getting ETF candlestick data: 'MongoDBConfig' object has no attribute 'get_database'
INFO:     127.0.0.1:57724 - "GET /crypto/etf-candlestick/10/E1VFVN30 HTTP/1.1" 200 OK
2025-09-23 17:33:45,789 - MainProcess - INFO - main - Getting ETF candlestick data for 10 days, symbol: E1VFVN30
2025-09-23 17:33:45,789 - MainProcess - ERROR - main - Error getting ETF candlestick data: 'MongoDBConfig' object has no attribute 'get_database'
INFO:     127.0.0.1:57724 - "GET /crypto/etf-candlestick/10/E1VFVN30 HTTP/1.1" 200 OK
2025-09-23 17:33:49,360 - MainProcess - INFO - main - Getting ETF candlestick data for 10 days, symbol: E1VFVN30
2025-09-23 17:33:49,360 - MainProcess - ERROR - main - Error getting ETF candlestick data: 'MongoDBConfig' object has no attribute 'get_database'
INFO:     192.168.110.164:50858 - "GET /crypto/etf-candlestick/10/E1VFVN30 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-23 17:34:59,466 - MainProcess - INFO - main - Shutting down application...
2025-09-23 17:34:59,466 - MainProcess - INFO - main - Application stopped successfully
INFO:     Application shutdown complete.
INFO:     Finished server process [1158645]
INFO:     Started server process [1160798]
INFO:     Waiting for application startup.
2025-09-23 17:35:03,688 - MainProcess - INFO - main - Starting application...
2025-09-23 17:35:03,688 - MainProcess - INFO - main - Application started successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8010 (Press CTRL+C to quit)
